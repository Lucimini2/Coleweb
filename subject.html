<!doctype html>
<!-- Página de recursos por asignatura: lee ?subject= y lista recursos desde subjects.json -->
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Recursos de asignatura</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-slate-100">
  <div class="max-w-5xl mx-auto p-6">
    <header class="flex items-center gap-3 mb-4">
      <a id="backLink" class="text-slate-300 border border-slate-700 bg-slate-800 rounded-md px-3 py-2 hover:border-indigo-400" href="asignaturas.html">Volver</a>
      <h1 id="title" class="text-2xl font-semibold">Asignatura</h1>
    </header>
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4" id="grid"></div>
    <div class="text-slate-400 border border-dashed border-slate-700 rounded-xl p-4 bg-slate-800" id="empty" style="display:none">Sin recursos aún para esta asignatura.</div>
  </div>
  <script>
    const gridEl = document.getElementById('grid');
    const emptyEl = document.getElementById('empty');
    const titleEl = document.getElementById('title');

    function getParam(name) {
      const url = new URL(window.location.href);
      return url.searchParams.get(name) || '';
    }

    async function init() {
      const subject = getParam('subject');
      titleEl.textContent = subject || 'Asignatura';
      let data = {};
      try {
        const res = await fetch('subjects.json');
        data = await res.json();
      } catch (e) {
        data = {
          'Mates': [
            { title: 'Tablas de multiplicar', description: 'Del 1 al 10 con respuestas múltiples', href: 'tablas.html' }
          ],
          'Lengua': [],
          'Inglés': [],
          'Francés': [],
          'Biologia': [],
          'Historia': []
        };
      }

      const items = data[subject] || [];
      gridEl.innerHTML = '';
      if (!items.length) {
        emptyEl.style.display = '';
        return;
      }
      emptyEl.style.display = 'none';
      items.forEach(item => {
        if ((item.href || '').includes('tablas.html')) {
          const card = document.createElement('div');
          card.className = 'bg-slate-800 border border-slate-700 rounded-xl p-4';
          const h2 = document.createElement('h2');
          h2.className = 'text-lg mb-2';
          h2.textContent = item.title;
          const span = document.createElement('span');
          span.className = 'text-sm text-slate-400';
          span.textContent = item.description || '';
          const btns = document.createElement('div');
          btns.className = 'flex gap-2 mt-3';
          const mkBtn = (label, href, active) => {
            const a = document.createElement('a');
            a.href = href;
            a.className = active
              ? 'bg-indigo-600 border border-indigo-700 text-white rounded-lg px-4 py-2'
              : 'bg-slate-800 border border-slate-700 text-slate-100 rounded-lg px-4 py-2 hover:border-indigo-400 hover:bg-slate-700';
            a.textContent = label;
            return a;
          };
          btns.appendChild(mkBtn('Apuntes', 'tablas_apuntes.html', false));
          btns.appendChild(mkBtn('Práctica', 'tablas_practica.html', false));
          btns.appendChild(mkBtn('Examen', 'tablas_examen.html', false));
          card.appendChild(h2);
          card.appendChild(span);
          card.appendChild(btns);
          gridEl.appendChild(card);
        } else if (item.notes_href || item.practice_href) {
          const card = document.createElement('div');
          card.className = 'bg-slate-800 border border-slate-700 rounded-xl p-4';
          const h2 = document.createElement('h2');
          h2.className = 'text-lg mb-2';
          h2.textContent = item.title;
          const span = document.createElement('span');
          span.className = 'text-sm text-slate-400';
          span.textContent = item.description || '';
          const btns = document.createElement('div');
          btns.className = 'flex gap-2 mt-3';
          if (item.notes_href) {
            const a = document.createElement('a');
            a.href = item.notes_href;
            a.className = 'bg-slate-800 border border-slate-700 text-slate-100 rounded-lg px-4 py-2 hover:border-indigo-400 hover:bg-slate-700';
            a.textContent = 'Apuntes';
            btns.appendChild(a);
          }
          if (item.practice_href) {
            const a = document.createElement('a');
            a.href = item.practice_href;
            a.className = 'bg-slate-800 border border-slate-700 text-slate-100 rounded-lg px-4 py-2 hover:border-indigo-400 hover:bg-slate-700';
            a.textContent = 'Práctica';
            btns.appendChild(a);
          }
          card.appendChild(h2);
          card.appendChild(span);
          card.appendChild(btns);
          gridEl.appendChild(card);
        } else {
          const a = document.createElement('a');
          a.className = 'block bg-slate-800 border border-slate-700 rounded-xl p-4 transition duration-150 hover:-translate-y-1 hover:border-indigo-400 hover:bg-slate-700';
          a.href = item.href || '#';
          const h2 = document.createElement('h2');
          h2.className = 'text-lg mb-2';
          h2.textContent = item.title;
          const span = document.createElement('span');
          span.className = 'text-sm text-slate-400';
          span.textContent = item.description || '';
          a.appendChild(h2);
          a.appendChild(span);
          gridEl.appendChild(a);
        }
      });
    }
    init();
  </script>
  <!-- Redirección del botón Atrás del navegador hacia asignaturas.html -->
  <script>
    (function(){
      try {
        history.pushState({cw:1}, '', window.location.href);
        window.addEventListener('popstate', function(){ location.href = new URL('asignaturas.html', window.location.href).href; });
        var back = document.getElementById('backLink');
        if (back) {
          back.addEventListener('click', function(e){
            e.preventDefault();
            location.href = new URL('asignaturas.html', window.location.href).href;
          });
        }
      } catch(e){}
    })();
  </script>
</body>
</html>
