<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Recursos de asignatura</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-slate-100">
  <div class="max-w-5xl mx-auto p-6">
    <header class="flex items-center gap-3 mb-4">
      <a class="text-slate-300 border border-slate-700 bg-slate-800 rounded-md px-3 py-2 hover:border-indigo-400" href="index.html">Volver</a>
      <h1 id="title" class="text-2xl font-semibold">Asignatura</h1>
    </header>
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4" id="grid"></div>
    <div class="text-slate-400 border border-dashed border-slate-700 rounded-xl p-4 bg-slate-800" id="empty" style="display:none">Sin recursos aún para esta asignatura.</div>
  </div>
  <script>
    const gridEl = document.getElementById('grid');
    const emptyEl = document.getElementById('empty');
    const titleEl = document.getElementById('title');

    function getParam(name) {
      const url = new URL(window.location.href);
      return url.searchParams.get(name) || '';
    }

    async function init() {
      const subject = getParam('subject');
      titleEl.textContent = subject || 'Asignatura';
      let data = {};
      try {
        const res = await fetch('subjects.json');
        data = await res.json();
      } catch (e) {
        data = {
          'Mates': [
            { title: 'Tablas de multiplicar', description: 'Del 1 al 10 con respuestas múltiples', href: 'tablas.html' }
          ],
          'Lengua': [],
          'Inglés': [],
          'Francés': [],
          'Biologia': [],
          'Historia': []
        };
      }

      const items = data[subject] || [];
      gridEl.innerHTML = '';
      if (!items.length) {
        emptyEl.style.display = '';
        return;
      }
      emptyEl.style.display = 'none';
      items.forEach(item => {
        if ((item.href || '').includes('tablas.html')) {
          const card = document.createElement('div');
          card.className = 'bg-slate-800 border border-slate-700 rounded-xl p-4';
          const h2 = document.createElement('h2');
          h2.className = 'text-lg mb-2';
          h2.textContent = item.title;
          const span = document.createElement('span');
          span.className = 'text-sm text-slate-400';
          span.textContent = item.description || '';
          const btns = document.createElement('div');
          btns.className = 'flex gap-2 mt-3';
          const mkBtn = (label, mode, active) => {
            const a = document.createElement('a');
            a.href = 'tablas.html?mode=' + mode;
            a.className = active
              ? 'bg-indigo-600 border border-indigo-700 text-white rounded-lg px-4 py-2'
              : 'bg-slate-800 border border-slate-700 text-slate-100 rounded-lg px-4 py-2 hover:border-indigo-400 hover:bg-slate-700';
            a.textContent = label;
            return a;
          };
          const btnApuntes = document.createElement('button');
          btnApuntes.className = 'bg-slate-800 border border-slate-700 text-slate-100 rounded-lg px-4 py-2 hover:border-indigo-400 hover:bg-slate-700';
          btnApuntes.textContent = 'Apuntes';
          const notesPane = document.createElement('div');
          notesPane.className = 'mt-3';
          btnApuntes.addEventListener('click', () => {
            const grid = document.createElement('div');
            grid.className = 'grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3';
            for (let t = 1; t <= 10; t++) {
              const cardT = document.createElement('div');
              cardT.className = 'bg-slate-800 border border-slate-700 rounded-xl p-4';
              const h3 = document.createElement('h3');
              h3.className = 'text-lg mb-2';
              h3.textContent = 'Tabla del ' + t;
              const ul = document.createElement('ul');
              ul.className = 'space-y-1 text-slate-300';
              for (let i = 1; i <= 10; i++) {
                const li = document.createElement('li');
                li.textContent = t + ' × ' + i + ' = ' + (t * i);
                ul.appendChild(li);
              }
              cardT.appendChild(h3);
              cardT.appendChild(ul);
              grid.appendChild(cardT);
            }
            notesPane.innerHTML = '';
            notesPane.appendChild(grid);
          });
          btns.appendChild(btnApuntes);
          btns.appendChild(mkBtn('Práctica', 'practica', false));
          btns.appendChild(mkBtn('Examen', 'examen', false));
          card.appendChild(h2);
          card.appendChild(span);
          card.appendChild(btns);
          card.appendChild(notesPane);
          gridEl.appendChild(card);
        } else {
          const a = document.createElement('a');
          a.className = 'block bg-slate-800 border border-slate-700 rounded-xl p-4 transition duration-150 hover:-translate-y-1 hover:border-indigo-400 hover:bg-slate-700';
          a.href = item.href || '#';
          const h2 = document.createElement('h2');
          h2.className = 'text-lg mb-2';
          h2.textContent = item.title;
          const span = document.createElement('span');
          span.className = 'text-sm text-slate-400';
          span.textContent = item.description || '';
          a.appendChild(h2);
          a.appendChild(span);
          gridEl.appendChild(a);
        }
      });
    }
    init();
  </script>
</body>
</html>