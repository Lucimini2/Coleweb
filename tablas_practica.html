<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Práctica: Tablas de multiplicar</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-slate-100">
  <div class="max-w-5xl mx-auto p-6">
    <header class="flex items-center gap-3 mb-4">
      <a class="text-slate-300 border border-slate-700 bg-slate-800 rounded-md px-3 py-2 hover:border-indigo-400" href="subject.html?subject=Mates">Volver</a>
      <h1 class="text-2xl font-semibold">Práctica: Tablas de multiplicar</h1>
    </header>
    <div class="bg-slate-800 border border-slate-700 rounded-xl p-4">
      <div class="flex flex-wrap items-center gap-3 mb-3">
        <label for="tablaSelect">Tabla:</label>
        <select id="tablaSelect" class="bg-slate-800 border border-slate-700 text-slate-100 rounded-md px-3 py-2"></select>
        <button id="infinitoBtn" class="bg-slate-800 border border-slate-700 text-slate-100 rounded-md px-3 py-2 hover:border-indigo-400 hover:bg-slate-700">Infinito</button>
        <div id="score" class="ml-auto text-slate-400"></div>
      </div>
      <div id="question" class="text-xl font-medium mb-3"></div>
      <div id="options" class="grid grid-cols-1 sm:grid-cols-3 gap-3"></div>
      <div class="flex gap-2 mt-4">
        <button id="next" class="bg-indigo-600 border border-indigo-700 text-white rounded-lg px-4 py-2 disabled:opacity-60 disabled:cursor-not-allowed" disabled>Siguiente</button>
        <button id="reset" class="bg-slate-800 border border-slate-700 text-slate-100 rounded-lg px-4 py-2 hover:border-indigo-400 hover:bg-slate-700">Reiniciar</button>
      </div>
    </div>
  </div>
  <script>
    const tablaSelect = document.getElementById('tablaSelect');
    const infinitoBtn = document.getElementById('infinitoBtn');
    const score = document.getElementById('score');
    const question = document.getElementById('question');
    const options = document.getElementById('options');
    const next = document.getElementById('next');
    const reset = document.getElementById('reset');
    let tabla = 1;
    let multiplicador = 1;
    let correcto = 1;
    let aciertos = 0;
    let total = 0;
    let respondido = false;
    let pool = [];
    let infinito = false;
    function randomInt(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }
    function generarOpciones(correct){ const s=new Set([correct]); while(s.size<3){ const delta=[1,2,3,4,5][randomInt(0,4)]*(Math.random()<0.5?-1:1); const c=correct+delta; if(c>0&&c<=100) s.add(c);} return Array.from(s).sort(()=>Math.random()-0.5); }
    function initTablaSelect(){ tablaSelect.innerHTML=''; for(let i=1;i<=10;i++){ const opt=document.createElement('option'); opt.value=String(i); opt.textContent='Tabla del '+i; tablaSelect.appendChild(opt);} tablaSelect.value='1'; tablaSelect.addEventListener('change',()=>{ tabla=parseInt(tablaSelect.value,10); reiniciar(true); }); }
    function actualizarScore(){ score.textContent='Aciertos: '+aciertos+' / '+total; }
    function initPool(){ pool=Array.from({length:10},(_,i)=>i+1).sort(()=>Math.random()-0.5); }
    function renderPregunta(){ if(!infinito){ if(pool.length===0){ mostrarFin(); return; } multiplicador=pool.pop(); } else { multiplicador=randomInt(1,10); } correcto=tabla*multiplicador; question.textContent=tabla+' × '+multiplicador+' = ?'; options.innerHTML=''; const opts=generarOpciones(correcto); const base='px-4 py-3 rounded-lg border border-slate-700 bg-slate-800 text-slate-100 transition disabled:opacity-70 hover:border-indigo-400 hover:bg-slate-700'; opts.forEach(v=>{ const b=document.createElement('button'); b.className=base; b.textContent=String(v); b.addEventListener('click',()=>seleccionar(v,b)); options.appendChild(b); }); next.disabled=true; respondido=false; }
    function seleccionar(valor,btn){ if(respondido) return; respondido=true; total+=1; const btns=Array.from(options.querySelectorAll('button')); btns.forEach(b=>b.disabled=true); const removeBase=b=>{ b.classList.remove('bg-slate-800','border-slate-700','text-slate-100'); }; if(valor===correcto){ aciertos+=1; removeBase(btn); btn.classList.add('bg-green-500','text-green-950','border-green-600'); } else { removeBase(btn); btn.classList.add('bg-red-500','text-red-950','border-red-600'); const correctoBtn=btns.find(b=>parseInt(b.textContent,10)===correcto); if(correctoBtn){ removeBase(correctoBtn); correctoBtn.classList.add('bg-green-500','text-green-950','border-green-600'); } } actualizarScore(); next.disabled=false; }
    function mostrarFin(){ question.textContent='Has terminado la tabla del '+tabla+'. Aciertos: '+aciertos+' / 10'; options.innerHTML=''; next.disabled=true; }
    function reiniciar(keepTabla){ aciertos=0; total=0; actualizarScore(); if(!keepTabla) tablaSelect.value=String(tabla); infinito=false; infinitoBtn.classList.remove('bg-indigo-600','border-indigo-700','text-white'); initPool(); renderPregunta(); }
    next.addEventListener('click',()=>renderPregunta());
    reset.addEventListener('click',()=>reiniciar(true));
    infinitoBtn.addEventListener('click',()=>{ infinito=true; infinitoBtn.classList.add('bg-indigo-600','border-indigo-700','text-white'); aciertos=0; total=0; actualizarScore(); renderPregunta(); });
    initTablaSelect();
    initPool();
    reiniciar(true);
  </script>
</body>
</html>